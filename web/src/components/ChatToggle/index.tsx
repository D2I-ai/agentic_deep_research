import React, { useState } from 'react';
import { message } from 'antd';
import { useClipboard } from '@/hooks/cpoy'

// 定义背景色类型，可以是字符串或者null
type BackgroundColor = string | null;
interface TypingMessageProps {
    text: string,
}

const SpanToggleBackground: React.FC<TypingMessageProps> = ({ text }) => {
    // 设置初始状态类型为BackgroundColor数组
    const [backgrounds, setBackgrounds] = useState<BackgroundColor[]>([null, null, null]);
    const [fillColor, setFillColor] = useState<any[]>(['#0057ff', '#0057ff', '#0057ff']);
    const [active,setActive] = useState(-1)
    const [messageApi, contextHolder] = message.useMessage();
    const { copyTextToClipboard } = useClipboard()
    const copyText = async (text: string) => {
        copyTextToClipboard(text).then(_ => {
            messageApi.open({
                type: 'success',
                content: '复制成功',
            });
        }).catch(_ => {
            messageApi.open({
                type: 'error',
                content: '无法复制',
            });
        })
    };
    // 处理点击事件的函数
    const toggleBackground = (index: number): void => {
        if (index < 2) {
            setBackgrounds(backgrounds.map((bg, idx) => {
                if (idx === index) {
                    if(active === index) {
                        setActive(-1)
                        return bg = null;
                    }
                    setActive(index)
                    return bg = '#0057ff';
                }
                return '#fff';
            }));
            setFillColor(fillColor.map((color, idx) => {
                if (idx === index) {
                    if(active === index) {
                        setActive(-1)
                        return color = '#0057ff';
                    }
                    return color = '#fff';
                } else {
                    return '#0057ff';
                }

            }));
        } else {
            copyText(text)
        }

    };

    const svgs = [
        (<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16197" id="mx_n_1709278530250" width="16" height="16"><path d="M119.51616 435.346286H62.391589L60.709303 899.584h58.806857v0.438857a28.891429 28.891429 0 0 1 0 57.636572v0.219428H47.689874c-2.194286 0.292571-4.315429 0-6.582857 0A40.96 40.96 0 0 1 0.000731 916.699429l0.365715-500.150858a41.398857 41.398857 0 0 1 46.153143-41.325714l72.118857-0.146286 0.877714-0.146285a30.208 30.208 0 0 1 0 60.342857zM969.143589 392.045714c14.189714 23.04 19.748571 49.005714 17.92 74.166857a43.154286 43.154286 0 0 1-1.170286 14.043429L897.024731 877.714286a41.910857 41.910857 0 0 1-5.851428 12.946285c-9.581714 19.236571-24.064 36.205714-43.300572 48.64-20.260571 13.019429-32.841143 18.651429-55.149714 18.578286l-10.093714 0.292572-577.024-0.292572h-12.361143V692.736l0.950857-256.438857V373.028571C315.246446 359.131429 417.134446 258.56 420.57216 133.485714c-0.365714-3.657143 0-7.314286 0-10.971428C420.57216 55.588571 464.677303 0 530.798446 0a119.954286 119.954286 0 0 1 116.443428 93.842286h0.585143c6.729143 30.646857 10.459429 62.464 10.459429 95.232 0 50.468571-10.678857 104.155429-26.185143 149.211428l236.982857 0.731429a44.617143 44.617143 0 0 1 6.290286 0.512c39.131429 1.609143 71.533714 16.310857 93.769143 52.589714z m-37.741715 61.001143h-0.292571a40.667429 40.667429 0 0 0-4.022857-33.499428 39.570286 39.570286 0 0 0-35.913143-19.017143l-16.969143-0.585143-275.456-0.292572c-22.674286 0-44.763429-2.194286-44.763429-25.088a41.691429 41.691429 0 0 1 4.242286-18.432l-0.365714-0.365714c16.384-31.012571 28.379429-64.731429 35.108571-100.425143h0.585143s5.412571-22.454857 5.339429-65.609143c0-34.157714-6.509714-65.974857-6.509715-65.974857 0-21.504-28.818286-59.392-58.002285-60.416-21.211429 0-56.905143 17.334857-51.2 61.147429 0 0 0.365714 33.426286-6.070857 67.072-2.706286 14.336-6.582857 27.794286-10.020572 38.326857l-0.219428-0.146286c-38.912 108.470857-114.541714 153.965714-217.6 200.411429l0.219428 470.235428 550.4 0.585143c1.828571 0 3.657143-0.219429 5.339429 0a38.546286 38.546286 0 0 0 30.354285-23.552l0.073143 0.073143 95.817143-424.448z" fill={fillColor[0]} p-id="16198"></path></svg>),
        (<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9921" width="16" height="16"><path d="M1015.694503 489.913805l-0.29958-0.898741-138.805583-393.748499c-0.19972-0.599161-0.499301-1.298182-0.699021-1.897342C852.223468 37.84699 797.999416 1.997203 737.683897 1.997203H123.943529C56.53794 1.997203 1.714728 56.820415 1.714728 124.226004v335.729761C1.714728 527.361354 56.53794 582.184566 123.943529 582.184566h174.85509c11.284195 0 15.678041 2.296783 25.763914 47.333703 5.492307 24.665452 11.783496 52.626289 28.859578 74.994958 15.2786 20.071886 31.056501 38.34629 46.235241 56.021534 28.360277 32.953843 55.222653 64.010344 76.592721 103.654817 29.858179 55.522233 29.558599 78.190483 29.159158 104.453697v0.599161c-0.29958 17.575383 8.088671 34.152165 22.16895 44.437758 14.180139 10.285594 32.554403 13.081677 49.131184 7.48951 51.627688-17.475523 86.478874-46.035521 103.355236-84.681391 18.274404-41.841395 14.279999-92.869922-11.883355-151.7874-42.939857-96.564747-31.056501-123.227402-28.160557-127.621248 4.293986-6.590769 16.976222-7.988811 26.962235-7.988811h232.274666c39.444752 0 75.394399-18.274404 98.66181-50.029925 23.16755-31.855382 29.658459-71.599714 17.775103-109.147124zM123.943529 65.907687h70.001952v452.366395h-70.001952C91.788567 518.274082 65.625212 492.110728 65.625212 459.955765V124.226004C65.625212 92.071041 91.788567 65.907687 123.943529 65.907687z m822.348183 495.406112c-11.084475 15.17874-28.260417 23.866571-47.034122 23.866571H666.982924c-46.634681 0-69.602512 20.171747-80.587126 37.048109-24.465732 37.64727-16.976222 97.463488 23.367271 188.336208 18.573984 41.841395 22.56839 75.494259 11.783495 100.159712-8.188531 18.573984-25.664054 33.652864-52.226849 44.837199-0.29958-27.761117-4.593566-61.913282-36.848388-121.82936-24.665452-45.73594-55.022932-80.986567-84.381811-115.138732-14.579579-16.976222-29.658459-34.451745-43.738738-52.92587-8.587971-11.284195-12.981817-31.056501-17.375663-50.229646-4.593566-20.571187-9.386852-41.741535-20.171746-59.616498-14.87916-24.565592-38.34629-37.547409-68.00475-37.54741h-40.942654V65.907687H737.683897c34.351885 0 65.308526 20.271607 78.989364 51.727548l138.206422 392.150736c5.492307 17.675243 2.396643 36.448948-8.587971 51.527828z" p-id="9922" fill={fillColor[1]}></path></svg>),
        (<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7451" id="mx_n_1709196797998" width="16" height="16"><path d="M703.351467 895.249067a63.8976 63.8976 0 0 1-63.965867 63.829333H127.931733a63.8976 63.8976 0 0 1-63.965866-63.829333V384.273067c0-35.293867 28.672-63.829333 63.965866-63.829334h63.8976v-63.8976h-63.8976A127.7952 127.7952 0 0 0 0 384.341333v510.976a127.658667 127.658667 0 0 0 127.863467 127.726934h511.3856a127.658667 127.658667 0 0 0 127.863466-127.658667v-63.8976h-63.8976v63.829333z m191.761066-894.293334H383.658667a127.7952 127.7952 0 0 0-127.863467 127.7952V639.658667c0 70.519467 57.207467 127.658667 127.863467 127.658666h511.522133c70.656 0 127.7952-57.207467 127.7952-127.658666V128.750933A127.7952 127.7952 0 0 0 895.112533 1.024z m63.965867 638.7712a63.829333 63.829333 0 0 1-63.8976 63.829334H383.658667a63.8976 63.8976 0 0 1-63.8976-63.829334V128.750933c0-35.2256 28.672-63.829333 63.8976-63.829333h511.522133c35.293867 0 63.8976 28.603733 63.8976 63.829333v510.976z" fill={fillColor[2]} p-id="7452"></path></svg>
        )]
    // 渲染三个span元素
    return (
        <div style={{ marginTop: '5px' }}>
            {backgrounds.map((bg: any, index) => (
                <span
                    key={index}
                    onClick={() => toggleBackground(index)}
                    style={{
                        background: bg || '#fff',
                        width: '35px',
                        height: '35px',
                        borderRadius: '50%',
                        textAlign: 'center',
                        padding: index == 0 ? '9px' : '10px',
                        cursor: 'pointer',
                        display: 'inline-flex',
                        marginRight: '5px',
                        justifyContent: 'center',
                        alignItems: 'center',
                    }}
                >
                    {svgs[index]}
                </span>
            ))}
            {contextHolder}
        </div>
    );
};

export default SpanToggleBackground;
